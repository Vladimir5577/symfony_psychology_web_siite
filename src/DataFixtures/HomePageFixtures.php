<?php

namespace App\DataFixtures;

use App\Entity\Block;
use App\Entity\Page;
use App\Entity\Post;
use Doctrine\Bundle\FixturesBundle\Fixture;
use Doctrine\Persistence\ObjectManager;

class HomePageFixtures extends Fixture
{
    public function load(ObjectManager $manager): void
    {
        $page = new Page();
        $page->setTitle('Главная');
        $page->setSlug('home');
        $page->setPosition(0);
        $page->setIsActive(true);
        $manager->persist($page);
        $this->addReference('page-home', $page);

        $blocksConfig = [
            [
                'title' => 'Hero',
                'slug' => 'hero',
                'description' => 'Главный баннер на главной странице.',
                'position' => 0,
                'posts' => [
                    [
                        'title' => 'Психологическое консультирование в атмосфере принятия и доверия',
                        'description' => 'Индивидуальные консультации для взрослых. Работаю с тревогой, стрессом, отношениями и кризисными состояниями. Опираюсь на доказательные методы и принципы профессиональной этики.',
                        'position' => 0,
                    ],
                    [
                        'title' => 'Ваш запрос — в центре внимания',
                        'description' => 'Не ставлю диагнозы и не даю советы «как жить». Помогаю разбираться в чувствах, находить опору и собственные решения. Темп и цели работы определяем вместе.',
                        'position' => 1,
                    ],
                    [
                        'title' => 'Первый шаг — запись на консультацию',
                        'description' => 'Связаться можно по телефону или через форму на сайте. На первой встрече обсудим ваш запрос и формат работы. Без обязательств продолжить — решение всегда за вами.',
                        'position' => 2,
                    ],
                ],
            ],
            [
                'title' => 'Marketing row',
                'slug' => 'marketing_block_row',
                'description' => 'Ключевые преимущества формата работы.',
                'position' => 1,
                'posts' => [
                    [
                        'title' => 'Индивидуальные консультации',
                        'description' => 'Работа один на один: только вы и психолог. Формат подстраивается под ваш запрос: краткосрочная поддержка или длительная работа над глубинными темами.',
                        'position' => 0,
                    ],
                    [
                        'title' => 'Онлайн и очно',
                        'description' => 'Консультации по видеосвязи (безопасная платформа) или очно в кабинете. Выбор формата — за вами, качество работы сохраняется в обоих вариантах.',
                        'position' => 1,
                    ],
                    [
                        'title' => 'Конфиденциальность и этика',
                        'description' => 'Всё, что вы говорите на сессиях, остаётся между нами. Соблюдаю кодекс профессиональной этики психолога и не разглашаю информацию третьим лицам.',
                        'position' => 2,
                    ],
                ],
            ],
            [
                'title' => 'Marketing featurette',
                'slug' => 'marketing_block_featurette',
                'description' => 'Подробнее о формате и принципах работы.',
                'position' => 2,
                'posts' => [
                    [
                        'title' => 'Как проходит первая консультация',
                        'description' => 'На первой встрече мы знакомимся, вы рассказываете о запросе и ожиданиях, я отвечаю на вопросы о формате работы. Вы можете оценить, насколько вам комфортно, и принять решение о продолжении. Никаких обязательств — только ваш осознанный выбор.',
                        'position' => 0,
                    ],
                    [
                        'title' => 'На каких подходах основана работа',
                        'description' => 'Опираюсь на методы, имеющие научное обоснование (в т.ч. когнитивно-поведенческий, гуманистический подход). Не использую эзотерику, диагностку по фото и прочие неподтверждённые практики. В фокусе — ваши цели и ваша система ценностей.',
                        'position' => 1,
                    ],
                    [
                        'title' => 'Кому подходят консультации',
                        'description' => 'Взрослым (18+), которые переживают тревогу, стресс, выгорание, сложности в отношениях или самооценке, кризисы и утраты. Не провожу работу с детьми и не подбираю медикаменты — при необходимости порекомендую обратиться к психиатру или другому специалисту.',
                        'position' => 2,
                    ],
                    [
                        'title' => 'Длительность сессии и курса',
                        'description' => 'Одна сессия — 50–60 минут. Частота встреч (обычно 1 раз в неделю) и длительность работы обсуждаются индивидуально и могут меняться в процессе. Краткосрочная работа возможна, так же как и длительная.',
                        'position' => 3,
                    ],
                    [
                        'title' => 'Запись, отмена и перенос',
                        'description' => 'Записаться можно по телефону или через форму на сайте. Прошу отменять или переносить сессию не позднее чем за 24 часа — так я смогу предложить это время другому клиенту. При внезапной болезни или форс-мажоре обсудим перенос отдельно.',
                        'position' => 4,
                    ],
                ],
            ],
            [
                'title' => 'Themes / Topics',
                'slug' => 'home_themes',
                'description' => 'С какими запросами можно обратиться.',
                'position' => 3,
                'posts' => [
                    [
                        'title' => 'Тревога и паника',
                        'description' => 'Генерализованная тревога, панические атаки, навязчивые мысли, хроническое напряжение. Работа над пониманием триггеров и стратегиями совладания.',
                        'position' => 0,
                    ],
                    [
                        'title' => 'Стресс и выгорание',
                        'description' => 'Профессиональное и эмоциональное выгорание, трудности с границами, ощущение «нет сил». Поддержка в восстановлении ресурса и пересмотре режима нагрузок.',
                        'position' => 1,
                    ],
                    [
                        'title' => 'Отношения и границы',
                        'description' => 'Сложности в паре, с родственниками, коллегами; одиночество; зависимые отношения; выстраивание здоровых границ.',
                        'position' => 2,
                    ],
                    [
                        'title' => 'Самооценка и самоопределение',
                        'description' => 'Неуверенность, самокритика, сложности с выбором и целями, экзистенциальные и возрастные кризисы, поиск себя.',
                        'position' => 3,
                    ],
                    [
                        'title' => 'Утрата и горе',
                        'description' => 'Поддержка в переживании потери близкого, развода, утраты здоровья или значимых жизненных опор. Без обесценивания чувств и без давления «быстрее справиться».',
                        'position' => 4,
                    ],
                ],
            ],
            [
                'title' => 'How it works',
                'slug' => 'home_how_it_works',
                'description' => 'Шаги от первого контакта до начала работы.',
                'position' => 4,
                'posts' => [
                    [
                        'title' => 'Свяжитесь со мной',
                        'description' => 'Позвоните или напишите через форму на сайте. Кратко опишите, с чем хотите разобраться (по желанию). Я отвечу в течение 1–2 рабочих дней и предложу варианты времени для первой встречи.',
                        'position' => 0,
                    ],
                    [
                        'title' => 'Выберите время и формат',
                        'description' => 'Договоримся о дате и времени первой консультации. Формат: онлайн (видеозвонок) или очная встреча в кабинете — как вам удобнее.',
                        'position' => 1,
                    ],
                    [
                        'title' => 'Первая консультация',
                        'description' => 'Обсудим ваш запрос, ваши ожидания и как строится работа. Вы сможете задать любые вопросы. После встречи вы решаете, хотите ли продолжать — без давления с моей стороны.',
                        'position' => 2,
                    ],
                    [
                        'title' => 'Дальнейшая работа',
                        'description' => 'Если решите продолжить — согласуем регулярность сессий и фокус работы. Темп и длительность курса мы можем корректировать по ходу дела.',
                        'position' => 3,
                    ],
                ],
            ],
            [
                'title' => 'CTA',
                'slug' => 'home_cta',
                'description' => 'Призыв записаться на консультацию.',
                'position' => 5,
                'posts' => [
                    [
                        'title' => 'Готовы обсудить свой запрос?',
                        'description' => 'Напишите или позвоните — мы согласуем время первой консультации. На встрече вы сможете рассказать о ситуации и задать любые вопросы о формате работы. Я отвечаю на обращения в течение 1–2 рабочих дней.',
                        'position' => 0,
                    ],
                ],
            ],
        ];

        foreach ($blocksConfig as $data) {
            $block = new Block();
            $block->setPage($page);
            $block->setTitle($data['title']);
            $block->setSlug($data['slug']);
            $block->setDescription($data['description']);
            $block->setPosition($data['position']);
            $block->setIsActive(true);
            $manager->persist($block);

            foreach ($data['posts'] as $postData) {
                $post = new Post();
                $post->setBlock($block);
                $post->setTitle($postData['title']);
                $post->setDescription($postData['description']);
                $post->setPosition($postData['position']);
                $post->setIsActive(true);
                $manager->persist($post);
            }
        }

        $manager->flush();
    }
}
